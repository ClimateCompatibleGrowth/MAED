/*
    *
    * Wijmo Library 5.20153.102
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the Wijmo Commercial License.
    * sales@wijmo.com
    * http://wijmo.com/products/wijmo-5/license/
    *
    */
var wijmo;(function(n){(function(t){(function(i){'use strict';var r=function(){function i(){}return i.export=function(t,i){var r=this.toWorkbookOM(t,i);return n.xlsx.XlsxConverter.export(r)},i.import=function(t,i,r,u){var f=n.xlsx.XlsxConverter.import(t);this.fromWorkbookOM(f,i,r,u)},i.toWorkbookOM=function(t,i){var r={sheets:[],creator:'',created:new Date,lastModifiedBy:'',modified:new Date,activeWorksheet:0},u,f;if(i&&i.activeWorksheet!=null&&i.activeWorksheet>0&&(r.activeWorksheet=i.activeWorksheet),n.isArray(t))for(u=0;u<t.length;u++)f=t[u],this._exportFlexGrid(f,r,i);else this._exportFlexGrid(t,r,i);return r},i.fromWorkbookOM=function(i,r,u,f){var ti=u?u.includeColumnHeader:!0,y=u?u.includeColumnHeader:!0,bt=1,w=0,e=0,h=0,nt,tt,it,rt,b,ut,at,k,kt,s,c,d,ft,l,et,ot,dt,vt,v,st,p,a,gt,ht,o,yt,pt,ct,ni,g,wt=!1,lt={};if(r.itemsSource=null,r.columns.clear(),r.rows.clear(),r.frozenColumns=0,r.frozenRows=0,i.sheets.length!==0)for(f&&(bt=i.sheets.length);w<bt;w++){for(yt={},pt={},h=0,it=[],ct=[],c=i.sheets[w],ti&&(h=1,c.rows.length<=1&&(y=!1,h=0),at=c.rows[0]),d=this._getColumnCount(c.rows),dt=c.summaryBelow,w>0&&(gt=document.createElement('div'),r=new t.FlexGrid(gt)),e=0;e<d;e++)r.columns.push(new t.Column),!c.cols[e]||(isNaN(+c.cols[e].width)||(r.columns[e].width=+c.cols[e].width),c.cols[e].visible||c.cols[e].visible==undefined||(r.columns[e].visible=!!c.cols[e].visible));for(;h<c.rows.length;h++){if(ft=!1,s=c.rows[h],s)for(et=h+1;et<c.rows.length;)if(ot=c.rows[et],ot){(isNaN(s.groupLevel)&&!isNaN(ot.groupLevel)||!isNaN(s.groupLevel)&&s.groupLevel<ot.groupLevel)&&(ft=!0);break}else et++;for(ft&&!dt?(v&&(v.isCollapsed=wt),v=new t.GroupRow,wt=s.collapsed==null?!1:s.collapsed,v.level=isNaN(s.groupLevel)?0:s.groupLevel,lt[v.level]=wt,this._checkParentCollapsed(lt,v.level)&&v._setFlag(128,!0),r.rows.push(v)):(vt=new t.Row,s&&this._checkParentCollapsed(lt,s.groupLevel)&&vt._setFlag(128,!0),r.rows.push(vt)),!s||!s.height||isNaN(s.height)||(r.rows[y?h-1:h].height=s.height),e=0;e<d;e++)if(s){if(l=s.cells[e],a=l?l.formula:undefined,a&&a[0]!=='='&&(a='='+a),a=a?this._parseToFlexSheetFormula(a):undefined,r.setCellData(y?h-1:h,e,a&&f?a:this._getItemValue(l)),!ft&&l&&l.value!=null&&l.value!==''&&this._setColumn(it,e,l),ht=h*d+e,o=l?l.style:undefined,o){if(ni=this._getItemType(l),o.hAlign)g=n.xlsx.XlsxConverter._parseHAlignToString(o.hAlign);else switch(ni){case 2:g='right';break;case 3:g='center';break;default:g='left'}yt[ht]={fontWeight:o.font&&o.font.bold?'bold':'none',fontStyle:o.font&&o.font.italic?'italic':'none',textDecoration:o.font&&o.font.underline?'underline':'none',textAlign:g,fontFamily:o.font&&o.font.family?o.font.family:'',fontSize:o.font&&o.font.size?o.font.size+'px':'',color:o.font&&o.font.color?o.font.color:'',backgroundColor:o.fill&&o.fill.color?o.fill.color:'',format:n.xlsx.XlsxConverter._parseExcelFormat(l)};o.font&&ct.indexOf(o.font.family)===-1&&ct.push(o.font.family)}if(l&&n.isNumber(l.rowSpan)&&n.isNumber(l.colSpan))for(nt=h;nt<h+l.rowSpan;nt++)for(tt=e;tt<e+l.colSpan;tt++)ht=nt*d+tt,pt[ht]=new t.CellRange(h,e,h+l.rowSpan-1,e+l.colSpan-1)}else r.setCellData(y?h-1:h,e,''),this._setColumn(it,e,undefined);!s||this._checkParentCollapsed(lt,s.groupLevel)||s.visible||s.visible==undefined||(r.rows[y?h-1:h].visible=s.visible)}for(c.frozenPane&&(st=c.frozenPane.columns,n.isNumber(st)&&!isNaN(st)&&(r.frozenColumns=st),p=c.frozenPane.rows,n.isNumber(p)&&!isNaN(p)&&(r.frozenRows=y&&p>0?p-1:p)),e=0;e<r.columnHeaders.columns.length;e++)rt=it[e],b=r.columns[e],b.required=!1,y?(k=at?at.cells[e]:undefined,k&&k.value?(kt=n.xlsx.XlsxConverter._parseExcelFormat(k),ut=n.Globalize.format(k.value,kt)):ut=this._numAlpha(e)):ut=this._numAlpha(e),b.header=ut,rt&&(b.dataType=rt.dataType,b.format=rt.format);f&&(r.wj_sheetInfo={name:c.name,visible:c.visible!==!1,styledCells:yt,mergedRanges:pt,fonts:ct});f&&w>0&&f.push(r)}},i._exportFlexGrid=function(i,r,u){var w=[],v=[],h={cols:[],rows:[],summaryBelow:!1},tt=0,b=u?u.includeColumnHeader:!0,k=u?u.needGetCellStyle:!0,c,ft,y,p,it,d,rt,l,f,e,s,a,ut,o,g,nt;if(s=i.wj_sheetInfo,h.name=s?s.name:'',h.visible=s?s.visible!==!1:!0,!s&&k&&(a=document.createElement('div'),a.style.visibility='hidden',i.hostElement.appendChild(a),ut=this._getCellStyle(i,a,0,0,"columnHeaders")||{}),b&&i.columnHeaders.rows.length>0)for(f=0;f<i.columnHeaders.rows.length;f++){for(c={cells:[]},c.height=ft||i.rows.defaultSize,e=0;e<i.columnHeaders.columns.length;e++){if(nt=1,g=1,y=i.columnHeaders.columns[e],rt=i.columnHeaders.getCellData(f,e,!0),o=i.getMergedRange(i.columnHeaders,f,e,!1),f===0&&(l=this._getColumnSetting(y,i.columnHeaders.columns.defaultSize),v.push(l)),o)if(f===o.topRow&&e===o.leftCol)g=o.bottomRow-o.topRow+1,nt=o.rightCol-o.leftCol+1;else{c.cells.push(undefined);continue}c.cells.push({value:rt,colSpan:nt,rowSpan:g,style:this._extend(this._parseCellStyle(ut),{font:{bold:!0},hAlign:l.style.hAlign})})}w.push(c)}else for(e=0;e<i.columnHeaders.columns.length;e++)y=i.columnHeaders.columns[e],l=this._getColumnSetting(y,i.columnHeaders.columns.defaultSize),v.push(l);for(h.cols=v,f=0;f<i.cells.rows.length;f++)p=i.rows[f],d=p instanceof t.GroupRow,d&&(it=n.tryCast(p,t.GroupRow),tt=it.level+1),w.push(this._parseFlexGridRowToSheetRow(i,p,f,v,b,k,d,tt));h.rows=w;h.frozenPane={rows:b?i.frozenRows+i.columnHeaders.rows.length:i.frozenRows,columns:i.frozenColumns};r.sheets.push(h);!s&&k&&i.hostElement.removeChild(a)},i._parseFlexGridRowToSheetRow=function(t,i,r,u,f,e,o,s){var ft=i.height,v,g,c,y,h,p,it,k,rt,a,l,nt,tt,w,ut,d,b;for(w=t.wj_sheetInfo,v={cells:[]},v.visible=i.isVisible,v.height=ft||t.rows.defaultSize,v.groupLevel=o?s-1:s,o&&(v.collapsed=i.isCollapsed),ut=i.constructor===n.grid.Row||i.constructor===n.grid._NewRowTemplate||i.constructor===n.grid.detail.DetailRow,!w&&e&&(d=document.createElement('div'),d.style.visibility='hidden',t.hostElement.appendChild(d)),c=0;c<t.columnHeaders.columns.length;c++){if(tt=1,nt=1,l=null,w?(rt=r*t.columns.length+c,w.mergedRanges&&(l=w.mergedRanges[rt]),w.styledCells&&(a=w.styledCells[rt])):e&&(a=this._getCellStyle(t,d,r,c)||{}),l||(l=t.getMergedRange(t.cells,r,c,!1)),l)if(r===l.topRow&&c===l.leftCol)nt=l.bottomRow-l.topRow+1,tt=l.rightCol-l.leftCol+1;else{v.cells.push(undefined);continue}g=u[c];ut||o?(h=t.getCellData(r,c,!0),p=t.getCellData(r,c,!1),k=!1,h&&n.isString(h)&&h.length>1&&h[0]==='='&&(k=!0),b=n.isDate(p)||k&&h.toLowerCase()==='=now()',y=a&&a.format?n.xlsx.XlsxConverter._parseCellFormat(a.format,b):g.style.format,y||(b?y='m/d/yyyy':n.isNumber(p)&&!n.isInt(p)?y='#,##0.00':n.isInt(p)&&(y=p.toString()===h?'#,##0':'General'))):(h=t.columnHeaders.getCellData(0,c,!0),y='General');o&&i.hasChildren&&c===t.columns.firstVisibleIndex?(it=h?h:i.dataItem&&i.dataItem.groupDescription?i.dataItem.groupDescription.propertyName+': '+i.dataItem.name+' ('+i.dataItem.items.length+' items)':'',b=n.isDate(it),v.cells.push({value:it,isDate:b,formula:k?this._parseToExcelFormula(h,b):null,colSpan:tt,rowSpan:nt,style:this._extend(this._parseCellStyle(a),{format:y,font:{bold:!0},hAlign:1,indent:s-1})})):v.cells.push({value:k?undefined:y==='General'?h:p,isDate:b,formula:k?this._parseToExcelFormula(h,b):null,colSpan:tt,rowSpan:nt,style:this._extend(this._parseCellStyle(a),{format:y,hAlign:a&&a.textAlign?n.xlsx.XlsxConverter._parseStringToHAlign(a.textAlign):n.isDate(p)&&!g.style.hAlign?1:g.style.hAlign})})}return!w&&e&&t.hostElement.removeChild(d),v},i._parseCellStyle=function(t){var i=t&&t.fontSize?+t.fontSize.substring(0,t.fontSize.indexOf('px')):14;return isNaN(i)&&(i=14),{font:{bold:t&&t.fontWeight&&t.fontWeight==='bold',italic:t&&t.fontStyle&&t.fontStyle==='italic',underline:t&&t.textDecoration&&t.textDecoration==='underline',family:t?this._parseToExcelFontFamily(t.fontFamily):'Arial',size:i,color:t&&t.color?t.color:undefined},fill:{color:t&&t.backgroundColor?t.backgroundColor:undefined},hAlign:t&&n.xlsx.XlsxConverter._parseStringToHAlign(t.textAlign)}},i._parseToExcelFontFamily=function(n){var t,i;return n?(t=n.indexOf('"'),i=n.lastIndexOf('"'),t>-1&&t!==i&&(n=n.substring(t+1,i))):n='Arial',n},i._parseToExcelFormula=function(t,i){var u=t.substring(1,t.indexOf('(')).toLowerCase(),r;switch(u){case'ceiling':case'floor':t=t.substring(0,t.lastIndexOf(')'))+', 1)';break;case'text':r=t.substring(t.lastIndexOf(','),t.lastIndexOf('\"'));r=n.xlsx.XlsxConverter._parseCellFormat(r.substring(r.lastIndexOf('\"')+1),i);t=t.substring(0,t.lastIndexOf(',')+1)+'\"'+r+'\")'}return t},i._parseToFlexSheetFormula=function(t){var u=t.substring(1).match(/\W+(\w+)\(/),r,f,e,o,i;f=u&&u.length===2?u[1]:t.substring(1,t.indexOf('('));e=t.indexOf(f);switch(f.toLowerCase()){case'ceiling':case'floor':t=t.substring(0,t.lastIndexOf(','))+')';break;case'text':r=t.substring(e);i=r.substring(r.indexOf('\"'),r.lastIndexOf('\"'));i=i.substring(i.lastIndexOf('\"')+1);o=i.indexOf('0')>-1?0:'';i=n.xlsx.XlsxConverter._parseExcelFormat({value:o,style:{format:i}});i=i.replace(/m+/g,function(n){return n.toUpperCase()}).replace(/Y+/g,function(n){return n.toLowerCase()}).replace(/M+:?|:?M+/gi,function(n){return n.indexOf(':')>-1?n.toLowerCase():n});t=t.substring(0,e)+r.substring(0,r.indexOf('\"')+1)+i+'\")'}return t},i._getColumnSetting=function(t,i){var r=t.size;return r=r||i,{autoWidth:!0,width:r,visible:t.visible,style:{format:t.format?n.xlsx.XlsxConverter._parseCellFormat(t.format,t.dataType===4):'',hAlign:n.xlsx.XlsxConverter._parseStringToHAlign(this._toExcelHAlign(t.getAlignment()))}}},i._toExcelHAlign=function(n){return(n=n?n.trim().toLowerCase():n,!n)?n:n.indexOf('center')>-1?'center':n.indexOf('right')>-1||n.indexOf('end')>-1?'right':n.indexOf('justify')>-1?'justify':'left'},i._getColumnCount=function(n){for(var r=0,t,i=0;i<n.length;i++)t=n[i]?n[i].cells:[],t&&t.length>r&&(r=t.length);return r},i._numAlpha=function(n){var t=Math.floor(n/26)-1;return(t>-1?this._numAlpha(t):'')+this._alphabet.charAt(n%26)},i._getItemType=function(t){return t===undefined||t===null||t.value===undefined||t.value===null||isNaN(t.value)?undefined:n.getType(t.value)},i._setColumn=function(t,i,r){var u,e,f=t[i];f?(u=this._getItemType(r),f.dataType!==u&&u!=undefined&&(f.dataType===3&&u!==3||u===2||u===4)&&(f.dataType=u),e=n.xlsx.XlsxConverter._parseExcelFormat(r),e&&f.format!==e&&e!=='General'&&(f.format=e)):t[i]={dataType:this._getItemType(r),format:n.xlsx.XlsxConverter._parseExcelFormat(r)}},i._getItemValue=function(t){if(t===undefined||t===null||t.value===undefined||t.value===null)return undefined;var i=t.value;return n.isNumber(i)&&isNaN(i)?'':i instanceof Date&&isNaN(i.getTime())?'':i},i._getCellStyle=function(n,t,i,r,u){typeof u=="undefined"&&(u="cells");try{n.cellFactory.updateCell(n[u],i,r,t)}catch(f){return undefined}return window.getComputedStyle(t)},i._extend=function(t,i){var r,u;for(r in i)u=i[r],n.isObject(u)&&t[r]?n.copy(t[r],u):t[r]=u;return t},i._checkParentCollapsed=function(n,t){var i=!1;return Object.keys(n).forEach(function(r){n[r]===!0&&i===!1&&!isNaN(t)&&+r<t&&(i=!0)}),i},i._alphabet='ABCDEFGHIJKLMNOPQRSTUVWXYZ',i}();i.FlexGridXlsxConverter=r})(t.xlsx||(t.xlsx={}));var i=t.xlsx})(n.grid||(n.grid={}));var t=n.grid})(wijmo||(wijmo={}))